{% comment %}
  Cart Page - Matches React cart modal styling
{% endcomment %}

<div class="cart-page-wrapper" style="min-height: calc(100vh - 40px); padding: 40px 20px; position: relative; top: 40px; background-color: white;">
  <div class="cart-container" style="max-width: 1200px; margin: 0 auto;">
    <h1 class="cart-title" style="font-family: 'Helvetica Neue LT Com', sans-serif; font-size: 2rem; text-transform: uppercase; margin-bottom: 2rem; color: black;">CART</h1>
    
    {% if cart.item_count == 0 %}
      <div class="empty-cart-message" style="text-align: center; padding: 4rem 2rem; font-family: 'Helvetica Neue LT Com', sans-serif; font-size: 1.2rem; color: black; text-transform: uppercase;">
        YOUR CART IS EMPTY
      </div>
    {% else %}
      <form action="{{ routes.cart_url }}" method="post" id="cart-form">
        <div class="cart-items-list" style="display: flex; flex-direction: column; gap: 0; border-top: 1px solid black; border-bottom: 1px solid black;">
          {% for item in cart.items %}
            <div class="cart-item" style="display: flex; gap: 1rem; padding: 1.5rem 0; border-bottom: 1px solid black;">
              <div class="cart-item-image" style="width: 100px; height: 130px; object-fit: cover; background: #f5f5f5; border: 1px solid #ddd;">
                <img 
                  src="{{ item.image | image_url: width: 200 }}" 
                  alt="{{ item.title }}" 
                  style="width: 100%; height: 100%; object-fit: cover; display: block;"
                />
              </div>
              
              <div class="cart-item-details" style="flex: 1; display: flex; flex-direction: column; gap: 0.5rem;">
                <div class="cart-item-header" style="display: flex; justify-content: space-between; align-items: flex-start;">
                  <div class="cart-item-name" style="font-family: 'Helvetica Neue LT Com', sans-serif; font-size: 1rem; font-weight: bold; color: black; text-transform: uppercase;">
                    {{ item.product.title }}
                  </div>
                  <div class="cart-item-price" style="font-family: 'Helvetica Neue LT Com', sans-serif; font-size: 1rem; color: black; font-weight: bold;">
                    {{ item.final_line_price | money }}
                  </div>
                </div>
                
                {% if item.variant.title != 'Default Title' %}
                  <div class="cart-item-variant" style="font-family: 'Sequel Sans Regular', sans-serif; font-size: 0.85rem; color: #666; text-transform: uppercase;">
                    {{ item.variant.title }}
                  </div>
                {% endif %}
                
                <div class="cart-item-actions" style="display: flex; gap: 1rem; align-items: center; margin-top: 0.5rem;">
                  <div class="quantity-control" style="display: flex; align-items: center; gap: 0.5rem; border: 1px solid black;">
                    <button 
                      type="button" 
                      class="quantity-button" 
                      onclick="updateQuantity({{ item.id }}, {{ item.quantity | minus: 1 }})"
                      style="background: white; border: none; padding: 0.5rem 0.75rem; cursor: pointer; font-family: 'Helvetica Neue LT Com', sans-serif; font-size: 1rem; color: black;"
                    >
                      -
                    </button>
                    <input 
                      type="number" 
                      name="updates[{{ item.id }}]" 
                      value="{{ item.quantity }}" 
                      min="1"
                      class="quantity-input"
                      style="width: 50px; text-align: center; border: none; padding: 0.5rem; font-family: 'Helvetica Neue LT Com', sans-serif; font-size: 0.9rem; background: transparent;"
                      onchange="this.form.submit()"
                    />
                    <button 
                      type="button" 
                      class="quantity-button" 
                      onclick="updateQuantity({{ item.id }}, {{ item.quantity | plus: 1 }})"
                      style="background: white; border: none; padding: 0.5rem 0.75rem; cursor: pointer; font-family: 'Helvetica Neue LT Com', sans-serif; font-size: 1rem; color: black;"
                    >
                      +
                    </button>
                  </div>
                  
                  <a 
                    href="{{ routes.cart_change_url }}?line={{ forloop.index }}&quantity=0" 
                    class="remove-button"
                    style="font-family: 'Sequel Sans Regular', sans-serif; font-size: 0.85rem; color: #666; text-decoration: underline; text-transform: uppercase; cursor: pointer;"
                  >
                    Remove
                  </a>
                </div>
              </div>
            </div>
          {% endfor %}
        </div>
        
        <div class="cart-footer" style="margin-top: 2rem; padding-top: 2rem; border-top: 1px solid black;">
          <div class="cart-total" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
            <span style="font-family: 'Helvetica Neue LT Com', sans-serif; font-size: 1.2rem; text-transform: uppercase; color: black; font-weight: bold;">TOTAL</span>
            <span style="font-family: 'Helvetica Neue LT Com', sans-serif; font-size: 1.2rem; color: black; font-weight: bold;">{{ cart.total_price | money }}</span>
          </div>
          
          <button 
            type="submit" 
            name="update" 
            class="update-button"
            style="width: 100%; padding: 1rem; background: white; border: 1px solid black; color: black; font-family: 'Helvetica Neue LT Com', sans-serif; font-size: 1rem; text-transform: uppercase; cursor: pointer; margin-bottom: 1rem; transition: all 0.3s;"
          >
            Update Cart
          </button>
          
          <a 
            href="{{ routes.root_url }}checkout" 
            class="checkout-button"
            style="display: block; width: 100%; padding: 1rem; background: black; color: white; text-align: center; font-family: 'Helvetica Neue LT Com', sans-serif; font-size: 1rem; text-transform: uppercase; text-decoration: none; transition: all 0.3s;"
          >
            Checkout
          </a>
        </div>
      </form>
    {% endif %}
  </div>
</div>

<script>
  function updateQuantity(itemId, newQuantity) {
    if (newQuantity < 1) {
      if (confirm('Remove this item from cart?')) {
        window.location.href = '{{ routes.cart_change_url }}?line=' + itemId + '&quantity=0';
      }
      return;
    }
    
    const form = document.getElementById('cart-form');
    const input = form.querySelector(`input[name="updates[${itemId}]"]`);
    if (input) {
      input.value = newQuantity;
      form.submit();
    }
  }
</script>

